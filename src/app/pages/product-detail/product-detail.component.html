<div class="container">
  <div class="container-wrapper">

    <!-- Sidebar -->
    <div class="sidebar text-dark" [class.active]="openSidebar" (mouseleave)="closeSidebar()"
      (mouseenter)="insideSidebar=true">
      <div class="product-cat">
        <ul class="show-all-outer">
          <li (click)="toggleShowAll()">
            <span>Show All Categories</span>
            @if (showAllCategory) {
            <i class="fa-solid fa-angle-up"></i>
            }
            @if (!showAllCategory) {
            <i class="fa-solid fa-angle-right"></i>
            }
            @if (showAllCategory) {
            <ul class="show-all-inner">
              <li><span>Accessories</span></li>
              <li><span>Bluetooth Speakers</span></li>
              <li><span>Cameras & Photography</span></li>
              <li><span>Computer Components</span></li>
              <li><span>Gadgets</span></li>
              <li><span>Headphones</span></li>
              <li><span>Home Entertainment</span></li>
              <li><span>Home Theatre</span></li>
              <li><span>Laptops & Computers</span></li>
              <li><span>Speakers</span></li>
            </ul>
            }
          </li>

          <li><b><span>Smart Phones & Tablets</span></b></li>
          <li><span>Smartphones</span></li>
          <li><span>Tablets</span></li>
        </ul>
      </div>

      <!-- Dark And Light Mood Button -->
      <!-- <div class="theme-toggle">
        <button (click)="toggleTheme()">
          Switch to {{ isDarkMode ? 'Light' : 'Dark' }} Mode
        </button>
      </div> -->


      <div class="ad-img">
        <img src="https://electro.madrasthemes.com/wp-content/uploads/2016/02/shop-sidebar-ad-banner.jpg"
          alt="ad-image">
      </div>

      <div class="latest-product">
        <div class="latest-product-title">
          <h3>Latest Products</h3>
        </div>
        @if(product && product.length > 0) {
        <div class="latest-product-inner">
          @for (item of product; track $index) {
          <app-latest-product [product]="item"></app-latest-product>
          }
        </div>
        }
      </div>

    </div>

    <!-- Product Detail -->
    <div class="product-detail">
      <div class="product-wrapper">
        <div class="product-image">
          <img [src]="data?.images" alt="product-image">
          <div class="img-link">
            <a [href]="data?.images" target="_blank"><i class="fa-solid fa-magnifying-glass"></i></a>
          </div>

          <div class="discounted-price">
            <span class="discount">
              {{ getDiscountPercent(data?.price??0, data?.discountPercentage??0) }}% OFF
            </span>
          </div>
        </div>
        <div class="product-info">
          <div class="inside-upper">
            <div class="category">
              <span>{{data?.category}}</span>
            </div>
            <div class="title">
              <h1>{{ data?.title }}</h1>
            </div>
            <div class="rating">
              <span><app-rating [rating]="data?.rating??0"></app-rating></span>
              <span class="review-count">(<span>{{data?.reviews?.length}}</span> customers reviews)</span>
            </div>
            <div class="avalability">
              @if(data?.availabilityStatus === 'Low Stock') {
              <p>Avalability: <span>{{data?.availabilityStatus}}</span></p>
              }
            </div>
          </div>
          <div class="inside-middle">
            <div class="action-btn">
              <span><i class="fa-regular fa-heart"></i> Wishlist</span>
              <span><i class="fa-solid fa-code-compare"></i> Compare</span>
            </div>
            <div class="tags">
              <li><span>{{data?.tags}}</span></li>
            </div>
          </div>
          <div class="inside-lower">
            <div class="price">
              <div class="price-wrapper">
                <span class="current-price">
                  @if (data?.price===data?.discountPercentage) {
                  <span class="fix-price">{{data?.price|currency}}</span>
                  }
                  @else {
                  <span class="new-price">{{data?.discountPercentage|currency}}</span>
                  <span class="old-price">{{data?.price|currency}}</span>
                  }
                </span>

              </div>
              <div class="add-to-cart">
                <input type="number" value="1" min="1">
                <button class="btn cart-btn"><i class="fa-solid fa-cart-arrow-down"></i> Add to Cart</button>
              </div>
            </div>
            <div class="payment-source">
              <p>Pay with <span><i class="fa-solid fa-angle-right"></i></span><strong> link</strong></p>
            </div>
          </div>
        </div>
      </div>
      <div class="product-description text-dark">
        <div class="title">
          <a (click)="showSection = 'review'" [class.active]="showSection==='review'">Review</a>
          <a (click)="showSection = 'products'" [class.active]="showSection==='products'">More Products</a>
        </div>
        <div class="review-box">
          @if (showSection=='review') {

          <div class="review-inner">
            <div class="review-summary">
              <app-review-summary [data]="data"></app-review-summary>
            </div>

            <div class="add-review">
              <div class="heading">
                <span>Add a review</span>
              </div>
              <div class="your-rating">
                <label for="your-rating">your rating</label>
                <div class="stars">
                  @for (star of stars; track $index) {
                  <i class="fa-star"
                    [ngClass]="{'fa-solid':star<(hovered || rating),'fa-regular':star>=(hovered || rating)}"
                    (mouseenter)="hovered = star + 1" (mouseleave)="hovered = 0" (click)="rate(star + 1)"></i>
                  }
                </div>
              </div>
              <div class="your-review">
                <label for="review">Your Review</label>
                <textarea name="review" id="review" cols="30" rows="10"
                  placeholder="Write your review here..."></textarea>
              </div>
              <div class="name">
                <label for="name">Name</label>
                <input type="text" id="name" placeholder="Enter your name">
              </div>
              <div class="email">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="Enter your email">
              </div>
              <div class="comment-save">
                <input type="checkbox" name="save" id="save">
                <label for="save">
                  Save my name, email, and website in this browser for the next time I comment.
                </label>
              </div>
              <div class="submit-btn">
                <button class="btn">Add Review</button>
              </div>
            </div>

          </div>

          <div class="reviewer">
            <div class="review-item ">
              <div class="reviewer-info">
                @if (data?.reviews?.length) {
                @for (item of data?.reviews; track $index) {
                <div class="reviewer-inner">
                  <div class="star">
                    @for (star of stars; track star; let i= $index) {
                    <i class="fa-star"
                      [ngClass]="{'fa-solid':i<(hovered || (item?.rating ?? 0)),'fa-regular':i>=(hovered || (item?.rating ?? 0))}"></i>
                    }
                  </div>
                  <p> {{item?.comment}}</p>

                  <span class="name"><strong>{{item?.reviewerName}}-</strong></span>
                  <span class="date">{{item?.date}}</span>
                  <p class="email"><strong>Email: </strong> <span>{{item?.reviewerEmail}}</span></p>
                </div>
                }
                }
                <!-- <p> {{data?.reviews?.[]?.comment}}</p>

                <span class="name"><strong>{{data?.reviews?.[]?.reviewerName}}-</strong></span>
                <span class="date">{{data?.reviews?.[]?.date}}</span> -->

              </div>
            </div>

          </div>
          }
          <div class="more-product">
            @if (showSection=='products') {
            @for (item of product; track $index) {
            @if($index >15&& $index < 22) { <app-product-item [Product]="item"></app-product-item>
              }
              }
              }

          </div>
        </div>
      </div>

      <div class="related-product">
        <div class="related-product-title">
          <p>Related Products</p>
        </div>
        <div class="related-product-items">
          @for (item of product; track $index) {
          @if ($index < 5) { <app-product-item [Product]="item"></app-product-item>
            }

            }
        </div>
      </div>

    </div>
  </div>
  <app-brand-carousel></app-brand-carousel>
  <app-footer-products></app-footer-products>
</div>
